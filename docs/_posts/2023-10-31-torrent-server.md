---
layout: post
title: сказ о том, как из нетбука торрентокачалку делал
---

# ТЗ
Имеется старый нетбук _Lenovo Ideapad_ c 32-х битным __Intel Atom N2600__ и __2GB ОЗУ__ на борту. Системой выбрал
стабильный на текущий момент _debian bookworm_, потому что от `x86` большинство дистров давно отказались, а у меня
планируется хоть и не настоящий, но всё-таки сервер.  

__TL;DR__ Пользоваться нетбуком по прямому назначению практически невозможно даже не из-за слабости самого железа, а из-за 
того, что процессор постоянно уходит в режим энергосбережения, а и без того унылый _атом_ на 600 МГц - зрелище совсем уж 
печальное. Пробовал разные линуксы, собирал вручную ядра, плясал с бубном вокруг cpufreqd и ему подобного - всё бестолку.
Максимум, чего _иногда_ удавалось добиться - непродолжительный подъем частоты. Но и при этом никогда она не становилась 
максимальной, и очень скоро опять падала до минимума.

Вдоволь намучившись, решил дать старичку еще один шанс, используя в качестве торренто-качалки и DLNA сервера. 
Если потянет, можно будет еще что-то прикрутить, типа локального веб-сервера, принт-сервера и т.д. хотя скорее всего
опять всё упрётся в 600МГц, потому что даже единственная закачка нагржает два потока под 40-45% при таких условиях.

## выбор torrent клиента
Недавно на другой машине ставил _rtorrent_, в работе никаких замечаний, кроме двух нюансов:
- крайне неудобно назначать файлы для частичной закачки  
- при аварийном выключении (свет пропал), сессия зависает, и перезапустить её можно только удалив файл сессии. что
приводит к тому, что частичные закачки становятся полными, ~~а я не ради этого полчаса доблил по пробелу~~ и тут же
стартует закачка _всех_ игнорировавшихся файлов  
- существуют вебморды, которые можно прикрутить к нему, но аскетичность программы намекает на то, что это могла бы 
быть нетривиальная задача  

Просмотрев вывод `apt search`, остановился на _transmission_ и _deluge_. оба умеют в демонов и в веб, начал с 
трансмиссии, как с более популярного клиента.

### transmission
__TL;DR__ И это был плохой выбор. Хотя, похоже, я лишь чуть-чуть не дожал. Подробности ниже.  
Установка тривиальная: `apt install transmission-daemon, transmission-remote`  
Настройки можно задать из консоли командами демону (легко но муторно), а можно через правку файла конфигурации.  
Первой проблемой стало то, что веб-морда никак не хотела меня пускать с другого локального айпишника.  
Решалось это выключением одного из `rpc_` параметров, в которых из-за похожести легко запутаться. И чтобы сработало
_наверняка_, надо было через `systemctl` останавливать демона, править системный конфиг где-то в `/var/` и запускать
 демона снова.  
Второй проблемой стал _постоянно_ отваливающаяся веб-морда. Соединение редко держалось хотя бы пару минут. Но с этим
я даже не стал разбираться из-за другого глюка: прав доступа.  
Когда я в первый раз попал на веб-страничку, то очень обрадовался: изначально я предполагал, что надо будет ручками
(например через `scp`) копировать `[filename].torrent` куда-то на сервер, и трансмиссия сама будет это подтягивать.
А тут оказалось, что я в диалоге указываю файл, физически лежащий на совсем другом компьютере, и он передается на 
сервер автоматически. А только вот ничего не качалось.  
Я уже было решил, что дело в кодировках и кириллице, мало ли чего не хватает в голом Дебиане, но потом понял, что
дело в правах доступа. И хотя я назначал их на целевую папку для пользователя `debian-transmission`, давал полный
доступ через `chmod -R ugo+rw`, искал в гугле - ничего не помогало.  
Да еще постоянно падающая веб-морда... В общём, решил удалить трансмиссию и попробовать что-то другое.

### deluge



ssh доступ
кодировки?
`su -`
`vbtool, setterm` 
`grub чотатам = 60`
