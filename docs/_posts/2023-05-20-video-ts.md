---
layout: post
title: ffmpeg and VOB 
---

Решил под вечер глянуть один фильмец и не разбираясь в деталях поставил закачку. Но только потом обнаружил, что скачал
DVD. Фильм хотел посмотреть на телеке, а он вряд ли переварит формат _VOB_, хотя можно было и проверить. Поскольку я
сижу на линуксе, пришлось обратиться к `ffmpeg`.  
Смутно припоминая, что из кучи _VOB_-файлов, нужны только самые объемные, нагуглил команду конвертации в `mp4`. С
приятным удивлением обранаружил, что процесс занял несколько секунд. Но сюрприз ждал меня дальше. Фильм разбит на 4 
куска. С первым всё было нормально, а вот у следующих эпизодов пропадала аудио-дорожка с русской озвучкой.  
Судя по сообщениям в консоли, `ffmpeg` терял точку отсчета, по которой надо выставлять аудио. Тогда я попробовал 
сначала склеить все _VOB_'ы в один и конвертировать уже его. Но с разными ключами получались разные проблемы. Все они
сводились к тому, что либо также не было русской озвучки, либо звук отсутстовал вообще; иногда это проявлялось 
сразу, иногда сразу после первого эпизода в склейке.  
я уже думал плюнуть и скачать другой вариант, но помогла вот эта команда:
```bash
ffmpeg -i "concat:VTS_01_1.VOB|VTS_01_2.VOB|VTS_01_3.VOB|VTS_01_4.VOB" -b:v 1500k -r 30 -vcodec h264 -strict -2 -acodec aac -ar 44100 -f mp4 convert.mp4
```

итого за _47 минут_ на моём стареньком двухъядерном `Pentium G3440T @ 2.80GHz` из _4х_ файлов общим объёмом около _4 Гб_ получился один корректный mp4-файл размером _855 Мб_.
